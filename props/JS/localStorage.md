`localStorage` - браузерный `API`, в `NodeJS` его нет. 

- При сохранении элемента в `localStorage`, он преобразуется в `string`. Он умеет работать и `работает только со строчными элементами`. (Лимит `~5 Мб`)

```
localStorage.setItem('test', toString(42)); 
/=/ Внутри происходит неявное преобразование в строку
```
---
При записи значений из `хранилища`, лучше работать с `localStorage.getItem('key')`, а не записывать значение в переменную. Тк переменная будет хранить старое значение и не обновится автоматически при изменении значения в `localStorage`.
___
Объекты хранилища `localStorage` и `sessionStorage` предоставляют одинаковые методы и свойства:
- `setItem(key, value)` – сохранить пару ключ/значение.
- `getItem(key)` – получить данные по ключу `key`.
- `removeItem(key)` – удалить данные с ключом `key`.
- `key(index)` – получить ключ на заданной позиции.
- `length` – количество элементов в хранилище.
- `clear()` – удалить всё.

``` 
/=/ Сохранить пару ключ/значение
localStorage.setItem("name", "John");

/=/ Получить данные по ключу
var name = localStorage.getItem("name");
console.log(name); /=/ Выведет "John"

/=/ Удалить данные с ключом
localStorage.removeItem("name");

/=/ Получить ключ на заданной позиции
var key = localStorage.key(0);
console.log(key); /=/ Выведет первый ключ в хранилище

/=/ Количество элементов в хранилище
var count = localStorage.length;
console.log(count); /=/ Выведет количество элементов в хранилище

/=/ Удалить всё
localStorage.clear();
```

### _Работа в разных вкладках_

Когда обновляются данные в `localStorage` или `sessionStorage`, генерируется событие `storage` со следующими свойствами:
- `key` – ключ, который обновился (`null`, если вызван `.clear()`).
- `oldValue` – старое значение (`null`, если ключ добавлен впервые).
- `newValue` – новое значение (`null`, если ключ был удалён).
- `url` – url документа, где произошло обновление.
- `storageArea` – объект `localStorage` или `sessionStorage`, где произошло обновление.

Событие `storage`:
- срабатывает при вызове `setItem`, `removeItem`, `clear`.
- срабатывает на всех остальных объектах `window`, где доступно хранилище, кроме того окна, которое его вызвало.

| `localStorage`                                                                | `sessionStorage`                                                           |
| ----------------------------------------------------------------------------- | -------------------------------------------------------------------------- |
| `Совместно используется между всеми вкладками и окнами с одинаковым источником` | `Разделяется в рамках вкладки браузера, среди ифреймов из того же источника` |
| `«Переживает» перезапуск браузера`                                              | `«Переживает» перезагрузку страницы (но не закрытие вкладки)`                                                                           |

___
Добавляет обработчик события `storage` к объекту `window`. Когда происходит изменение в объекте `localStorage` или `sessionStorage`, событие срабатывает.

```
window.addEventListener("storage", (event) => {
	console.log(event);
});
```

Особенность, связанная с использованием `window.addEventListener("storage", callback)` состоит в том, что событие `storage` будет срабатывать только `в других вкладках`, а не в текущей вкладке, где было изменено хранилище.

Это поведение обусловлено тем, что хранилище браузера разделяется между всеми вкладками, открытыми для вашего домена. Таким образом, когда происходит изменение в хранилище в одной вкладке, другие вкладки получают уведомление о изменении через событие `storage`.

Если вам нужно отслеживать изменения в хранилище в текущей вкладке, вам может потребоваться использовать другие методы, такие как `опрос хранилища с некоторой периодичностью` или использование других событий, например, события `beforeunload` или `unload`.